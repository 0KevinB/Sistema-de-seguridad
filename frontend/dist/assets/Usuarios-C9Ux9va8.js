import{r,c as d,a as e,b as U,d as p,v as m,t as i,F as I,k,o as v,q as B}from"./index-BOzkANz2.js";import{a as h}from"./adminService-D9fYIKvy.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"admin-view"},w={class:"filters"},C={class:"search-box"},x={key:0,class:"success-message"},A={key:1,class:"error-message"},H={class:"actions-container"},j={class:"action-card"},E={class:"action-form"},N=["disabled"],S={class:"action-card"},M={class:"action-form"},P=["disabled"],L={class:"action-card"},z={class:"action-form"},G=["disabled"],T={key:2,class:"historial-container"},X={class:"table-container"},J={class:"data-table"},K={__name:"Usuarios",setup(O){const q=r(""),o=r(""),n=r(""),l=r(!1),b=r([]),u=r({idUsuario:"",motivo:""}),c=r({idUsuario:""}),f=r({idUsuario:""}),y=async()=>{var t,a;if(!u.value.idUsuario){o.value="Por favor ingresa el ID del usuario";return}l.value=!0,o.value="",n.value="";try{const s=await h.bloquearCuenta(parseInt(u.value.idUsuario),u.value.motivo||"Bloqueado por administrador");n.value=s.mensaje||"Usuario bloqueado correctamente",u.value={idUsuario:"",motivo:""}}catch(s){o.value=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.mensaje)||"Error al bloquear usuario"}finally{l.value=!1}},g=async()=>{var t,a;if(!c.value.idUsuario){o.value="Por favor ingresa el ID del usuario";return}l.value=!0,o.value="",n.value="";try{const s=await h.desbloquearCuenta(parseInt(c.value.idUsuario));n.value=s.mensaje||"Usuario desbloqueado correctamente",c.value.idUsuario=""}catch(s){o.value=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.mensaje)||"Error al desbloquear usuario"}finally{l.value=!1}},_=async()=>{var t,a;if(!f.value.idUsuario){o.value="Por favor ingresa el ID del usuario";return}l.value=!0,o.value="",n.value="";try{const s=await h.obtenerHistorialAccesos(parseInt(f.value.idUsuario));b.value=s.historial||[],b.value.length===0&&(o.value="No se encontrÃ³ historial para este usuario")}catch(s){o.value=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.mensaje)||"Error al obtener historial"}finally{l.value=!1}},D=t=>new Date(t).toLocaleString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(t,a)=>(v(),d("div",V,[a[13]||(a[13]=e("h1",{class:"view-title"},"GestiÃ³n de Usuarios",-1)),a[14]||(a[14]=e("p",{class:"view-subtitle"},"Administrar cuentas de usuario del sistema",-1)),e("div",w,[e("div",C,[p(e("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>q.value=s),type:"text",placeholder:"Buscar por ID de usuario...",class:"search-input"},null,512),[[m,q.value]])])]),n.value?(v(),d("div",x,i(n.value),1)):U("",!0),o.value?(v(),d("div",A,i(o.value),1)):U("",!0),e("div",H,[e("div",j,[a[5]||(a[5]=e("h3",null,"Bloquear Usuario",-1)),a[6]||(a[6]=e("p",null,"Deshabilitar el acceso a una cuenta especÃ­fica",-1)),e("div",E,[p(e("input",{"onUpdate:modelValue":a[1]||(a[1]=s=>u.value.idUsuario=s),type:"number",placeholder:"ID del usuario",class:"form-input"},null,512),[[m,u.value.idUsuario]]),p(e("input",{"onUpdate:modelValue":a[2]||(a[2]=s=>u.value.motivo=s),type:"text",placeholder:"Motivo del bloqueo",class:"form-input"},null,512),[[m,u.value.motivo]]),e("button",{onClick:y,class:"btn-danger",disabled:l.value},i(l.value?"Bloqueando...":"ðŸš« Bloquear"),9,N)])]),e("div",S,[a[7]||(a[7]=e("h3",null,"Desbloquear Usuario",-1)),a[8]||(a[8]=e("p",null,"Habilitar el acceso a una cuenta bloqueada",-1)),e("div",M,[p(e("input",{"onUpdate:modelValue":a[3]||(a[3]=s=>c.value.idUsuario=s),type:"number",placeholder:"ID del usuario",class:"form-input"},null,512),[[m,c.value.idUsuario]]),e("button",{onClick:g,class:"btn-success",disabled:l.value},i(l.value?"Desbloqueando...":"âœ… Desbloquear"),9,P)])]),e("div",L,[a[9]||(a[9]=e("h3",null,"Ver Historial de Accesos",-1)),a[10]||(a[10]=e("p",null,"Consultar intentos de login de un usuario",-1)),e("div",z,[p(e("input",{"onUpdate:modelValue":a[4]||(a[4]=s=>f.value.idUsuario=s),type:"number",placeholder:"ID del usuario",class:"form-input"},null,512),[[m,f.value.idUsuario]]),e("button",{onClick:_,class:"btn-info",disabled:l.value}," ðŸ“‹ Ver Historial ",8,G)])])]),b.value.length>0?(v(),d("div",T,[a[12]||(a[12]=e("h2",null,"Historial de Accesos",-1)),e("div",X,[e("table",J,[a[11]||(a[11]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Usuario ID"),e("th",null,"Intentos Fallidos"),e("th",null,"Fecha Intento"),e("th",null,"Bloqueado")])],-1)),e("tbody",null,[(v(!0),d(I,null,k(b.value,s=>(v(),d("tr",{key:s.idAcceso},[e("td",null,i(s.idAcceso),1),e("td",null,i(s.idUsuario),1),e("td",null,i(s.intentosFallidos),1),e("td",null,i(D(s.fechaIntento)),1),e("td",null,[e("span",{class:B(s.bloqueado?"badge-danger":"badge-success")},i(s.bloqueado?"SÃ­":"No"),3)])]))),128))])])])])):U("",!0)]))}},Y=F(K,[["__scopeId","data-v-fe133f3b"]]);export{Y as default};
