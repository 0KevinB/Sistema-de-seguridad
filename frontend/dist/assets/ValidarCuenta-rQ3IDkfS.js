import{u as C,r as n,j as x,c as m,a,w as k,b as f,d as _,v as h,t as p,e as S,f as N,g as w,h as M,o as g,i as E}from"./index-BOzkANz2.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U={class:"auth-container"},j={class:"auth-card"},A={class:"form-group"},B=["disabled"],D={class:"form-group"},T=["disabled"],q={key:0,class:"error-message"},F={key:1,class:"success-message"},R=["disabled"],J={class:"auth-links"},O={__name:"ValidarCuenta",setup(P){const V=M(),b=C(),t=n({email:"",codigo:""}),r=n(null),o=n(!1),s=n(""),d=n("");x(()=>{const i=localStorage.getItem("pendingValidation");i&&(r.value=JSON.parse(i),t.value.email=r.value.email)});const y=async()=>{var i,e,u,l;o.value=!0,s.value="",d.value="";try{if(!r.value){s.value="No hay validación pendiente. Por favor regístrate primero.",o.value=!1;return}const c={idUsuario:r.value.idUsuario,idMFA:r.value.idMFA,codigo:t.value.codigo},v=await b.validarCuenta(c);v.success?(d.value="Cuenta validada correctamente. Redirigiendo al login...",localStorage.removeItem("pendingValidation"),setTimeout(()=>{V.push("/login")},2e3)):s.value=v.mensaje||v.message||"Error al validar cuenta"}catch(c){s.value=((e=(i=c.response)==null?void 0:i.data)==null?void 0:e.mensaje)||((l=(u=c.response)==null?void 0:u.data)==null?void 0:l.message)||"Error al conectar con el servidor"}finally{o.value=!1}};return(i,e)=>{const u=w("router-link");return g(),m("div",U,[a("div",j,[e[5]||(e[5]=a("h1",{class:"auth-title"},"Validar Cuenta",-1)),e[6]||(e[6]=a("p",{class:"auth-subtitle"},"Ingresa el código enviado a tu correo",-1)),a("form",{onSubmit:k(y,["prevent"]),class:"auth-form"},[a("div",A,[e[2]||(e[2]=a("label",{for:"email"},"Correo Electrónico",-1)),_(a("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=l=>t.value.email=l),required:"",disabled:o.value,placeholder:"tu@email.com"},null,8,B),[[h,t.value.email]])]),a("div",D,[e[3]||(e[3]=a("label",{for:"codigo"},"Código de Verificación",-1)),_(a("input",{type:"text",id:"codigo","onUpdate:modelValue":e[1]||(e[1]=l=>t.value.codigo=l),required:"",disabled:o.value,placeholder:"123456",maxlength:"6"},null,8,T),[[h,t.value.codigo]])]),s.value?(g(),m("div",q,p(s.value),1)):f("",!0),d.value?(g(),m("div",F,p(d.value),1)):f("",!0),a("button",{type:"submit",class:"btn-primary",disabled:o.value},p(o.value?"Validando...":"Validar Cuenta"),9,R)],32),a("div",J,[S(u,{to:"/login"},{default:N(()=>[...e[4]||(e[4]=[E("Volver al inicio de sesión",-1)])]),_:1})])])])}}},H=I(O,[["__scopeId","data-v-0b714b1c"]]);export{H as default};
